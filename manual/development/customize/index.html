<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><meta property="og:title" content="Collect custom artifacts"><meta property="og:type" content="article"><meta property="og:url" content="https://forensicanalysis.github.io/documentation/manual/development/customize/"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Elementary"><meta name=og:type content="article"><link rel=canonical content="https://forensicanalysis.github.io/documentation/manual/development/customize/"><meta name=generator content="Hugo 0.68.3"><title>Elementary | Development | Collect custom artifacts</title><link rel=stylesheet href=/documentation/css/style.d9d74fdc13c40e55d4570b1e4924d9bd385b16c5c98d19d3a3fee1f21b799fe8.css integrity="sha256-2ddP3BPEDlXUVwseSSTZvThbFsXJjRnTo/7h8ht5n+g="><link href=https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.css integrity="sha256-XUbSD3m+xLW27W/mp9kMn+fI9AU2MoBkiMMSVVYWI+o=" crossorigin=anonymous><style>ul.contributors{list-style-type:none}ul.contributors:after{content:'';width:100%}.contributors li{text-align:center;display:inline-block;padding-bottom:20px;margin-left:10px;width:150px}.contributors li img{text-align:center;width:100px;border-radius:50%}</style><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.4/mermaid.min.js integrity="sha512-KxXF2PTpQ6vOh92ibaJXQxPA4hTD6mSAHBPT8SxbfSh6DupjgwTT2wHcn7x3Q1vvD5JnFXK1C46q5PDHRnyWWg==" crossorigin=anonymous></script><link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400&display=swap" rel=stylesheet><style>h1,h2,h3,h4,.nav,.navbar,.title,.has-text-weight-bold,.toc{font-family:roboto slab,-apple-system,BlinkMacSystemFont,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif}.has-bottom-padding{padding-bottom:0}.hero-body,.section{padding:1.5rem}.footer{display:none}.has-text-weight-light{font-weight:600!important}.page{min-height:0}.nav-header{display:none}@media print{body{font-size:10pt}.has-restricted-width{max-width:100vh}}*{border-radius:0!important}</style></head><body class=has-navbar-fixed-top><div class=page><nav class="navbar is-expanded is-white is-fixed-top has-shadow" role=navigation aria-label=dropdown-navigation><div class=navbar-brand><a class="navbar-item is-size-5 is-size-6-mobile has-text-weight-bold" href=/documentation/>Elementary</a><div class="navbar-item is-expanded is-hidden-touch" id=search-navbar-item><div class=dropdown id=search-dropdown><div class=dropdown-trigger><p class="control has-icons-left"><input class="input is-static" placeholder=Search id=search-bar>
<span class="icon is-medium is-left"><ion-icon src=/documentation/img/icons/search.svg></ion-icon></span></p></div><div class=dropdown-menu id=search-menu><div class=dropdown-content id=search-content></div></div></div></div><a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbar-menu><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div class=navbar-menu id=navbar-menu><div class=navbar-end><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link is-arrowless" href=/documentation/manual/><span>Documentation</span>
<span class="icon has-text-primary"><ion-icon src=/documentation/img/icons/arrow-dropdown.svg></ion-icon></span></a><div class=navbar-dropdown><a class=navbar-item href=/documentation/manual/usage/><span>Usage</span></a>
<a class=navbar-item href=/documentation/manual/development/><span>Development</span></a></div></div><div class=navbar-item><div class=buttons><a class="button is-normal is-black" href=https://github.com/forensicanalysis target=_blank><span class=icon><ion-icon src=/documentation/img/icons/logo-github.svg></ion-icon></span></a><a class="button is-normal is-slack-aubergine" href=https://open-source-dfir.slack.com target=_blank><span class=icon><ion-icon src=/documentation/img/icons/logo-slack.svg></ion-icon></span></a></div></div></div></div></nav><div class=dashboard><div class="dashboard-sidebar has-border-right is-hidden-touch"><nav class="nav is-sticky"><header class=nav-header><nav class="level is-size-5"><div class=level-left><div class=level-item><p class="nav-header-title has-text-weight-bold">Docs</p></div><div class=level-item><span class="icon has-text-primary"><ion-icon src=/documentation/img/icons/apps.svg></ion-icon></span></div></div></nav></header><div class="nav-container is-scrollable"><div class=nav-section><header class=nav-section-header><a href=/documentation/manual/>The elementary documentation</a></header></div><div class=nav-section><header class=nav-section-header><a href=/documentation/manual/usage/>Usage</a></header><ul class=nav-section-links><li><a href=/documentation/manual/usage/acquisition/>Acquisition with the artifactcollector</a></li><li><a href=/documentation/manual/usage/processing/>Processing with elementary</a></li></ul></div><div class=nav-section><header class=nav-section-header><a href=/documentation/manual/development/>Development</a></header><ul class=nav-section-links><li><a class=is-active href=/documentation/manual/development/customize/>Collect custom artifacts</a></li><li><a href=/documentation/manual/development/cross/>Cross compilation</a></li><li><a href=/documentation/manual/development/plugins/>Elementary plugins</a></li><li><a href=/documentation/manual/development/forensicstore/>Forensicstore</a></li><li><a href=/documentation/manual/development/style_guide/>Artifact definition format and style guide</a></li></ul></div></div></nav></div><div class=dashboard-main><section class="hero is-white is-normal"><div class=hero-head style=padding-left:1.5rem><div class=container><nav class="breadcrumb is-center has-succeeds-separator" aria-label=breadcrumbs><ul><li><a href=/documentation/>Home</a></li><li><a href=/documentation/manual/>The elementary documentation</a></li><li><a href=/documentation/manual/development/>Development</a></li><li class=is-active><a href=/documentation/manual/development/customize/>Collect custom artifacts</a></li></ul></nav></div></div><div class=hero-body><div class=container><p class="title is-size-2 is-size-3-mobile has-text-dark has-text-weight-light">Collect custom artifacts</p></div></div></section><section class=section><div class=container><div class="content has-restricted-width has-bottom-padding"><p>Forensic investigations differ and investigators have different approaches in forensic cases. The artifactcollector can cater to these needs by collecting a different set of artifacts related to the situation.</p><h2 id=collect-a-custom-set-of-artifacts>Collect a custom set of artifacts</h2><ol><li>Clone the repository <code>git clone https://github.com/forensicanalysis/artifactcollector</code>.</li><li>Run <code>go generate</code> to download all artifacts.</li><li>Add artifact definition yaml files as needed in <code>pack/artifacts</code>. Do not edit the
artifact definitions, as they will be overwritten.</li><li>Edit <code>pack/ac.yaml</code> and add the artifacts you want to collect.</li><li>Run <code>go generate</code>. This might yield some errors or problems in your artifacts.</li><li>On windows you can move the syso into the root folder (e.g. <code>cp resources\artifactcollector.syso .</code>)
to enable the icon for the executable and the UAC popup.</li><li>Run <code>go build .</code> to generates an executable.</li></ol><h3 id=define-artifacts>Define artifacts</h3><p>A structured way to define forensic artifacts was introduced by Google in development of the grr endpoint client: <a href=https://github.com/ForensicArtifacts/artifacts>https://github.com/ForensicArtifacts/artifacts</a>. We use the forked <a href=https://github.com/forensicanalysis/artifacts>https://github.com/forensicanalysis/artifacts</a> as the main repository for
forensic artifacts definitions, because the main project contains <a href=https://github.com/forensicanalysis/artifacts#backgroundhistory>some issues</a>.</p><p>The artifacts are yaml documents that define different types of forensic artifacts:</p><ul><li>Paths</li><li>Directories</li><li>Files</li><li>Registry Keys and Values</li><li>WMI Queries</li><li>Command execution</li></ul><p>Letâ€™s have a look at an artifact definition for Windows Prefetch files. The artifact defines the location of the prefetch files on Windows.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: WindowsPrefetchFiles
<span style=color:#66d9ef>doc</span>: Windows Prefetch files.
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_systemroot%%\Prefetch\*.pf&#39;</span>]
    <span style=color:#66d9ef>separator</span>: <span style=color:#e6db74>&#39;\&#39;
</span><span style=color:#e6db74>labels: [System]
</span><span style=color:#e6db74>supported_os: [Windows]
</span><span style=color:#e6db74>urls: [&#39;</span>http://www.forensicswiki.org/wiki/Prefetch&#39;]
</code></pre></div><p>If added to the artifactcollector and included in the configuration file, the artifactcollector would collect all .pf files in <code>%%environ_systemroot%%\Prefetch</code>. The <code>%%environ_systemroot%%</code> variable is replaced by the artifactcollector using the WindowsEnvironmentVariableSystemRoot artifact definition. Creating artifacts like can be done on a case by case basis if needed.</p><p>The artifact definition format is described in detail in the
<a href=https://github.com/forensicanalysis/artifacts/blob/master/style_guide.md>Style Guide</a>.</p><h3 id=embed-binaries>Embed binaries</h3><p>Binaries can be added to <code>pack/bin</code> and than included into the artifactcollector
in the <code>go generate</code> step. Additionally a corresponding COMMAND artifact like
the following is required.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: Autoruns
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: COMMAND
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>cmd</span>: autorunsc.exe
    <span style=color:#66d9ef>args</span>: [<span style=color:#e6db74>&#34;-x&#34;</span>, <span style=color:#e6db74>&#34;-accepteula&#34;</span>]
<span style=color:#66d9ef>supported_os</span>: [Windows]
</code></pre></div><p>Currently the output to stdout and stderr is saved, but generated
files are not collected.</p></div></div></section><div id=navigation><section class=section><div class=container><div class="pagination has-restricted-width"><a class="button is-primary" href=/documentation/manual/development/><span class=icon><ion-icon src=/documentation/img/icons/arrow-back.svg></ion-icon></span><span><strong>Previous</strong>&nbsp;|&nbsp;Development</span></a>
<a class="button is-primary" href=/documentation/manual/development/cross/ style=float:right><span><strong>Next</strong>&nbsp;|&nbsp;Cross compilation</span>
<span class=icon><ion-icon src=/documentation/img/icons/arrow-forward.svg></ion-icon></span></a></div></div></section></div></div><div class="dashboard-toc is-hidden-touch"><div class="toc-container is-sticky"><nav class="level is-size-5"><div class=level-left><div class=level-item><p class=has-text-weight-bold>Content</p></div><div class=level-item><span class="icon has-text-primary"><ion-icon src=/documentation/img/icons/list.svg></ion-icon></span></div></div></nav><div class=toc></div></div></div></div><footer class=footer><section class="hero is-bold"><div class=hero-body><div class=container><div class="columns is-vcentered"><div class=column><p class="title is-size-3 is-size-4-mobile has-text-white-bis has-text-weight-light is-spaced">Elementary</p><p class="subtitle is-size-4 is-size-5-mobile has-text-light">Elementary is an open source toolset that enables acquisition and processing of artifacts for forensic investigations.</p><div class=buttons><a class="button is-small is-black is-inverted" href=https://github.com/forensicanalysis target=_blank><span class=icon><ion-icon src=/documentation/img/icons/logo-github.svg></ion-icon></span></a><a class="button is-small is-slack-aubergine is-inverted" href=https://open-source-dfir.slack.com target=_blank><span class=icon><ion-icon src=/documentation/img/icons/logo-slack.svg></ion-icon></span></a></div></div></div></div></div></section></footer></div><script src=/documentation/js/app.8aa12458222656d47218d0154d69257c4435211c645649b4c677859bc06fd46f.js integrity="sha256-iqEkWCImVtRyGNAVTWklfEQ1IRxkVkm0xneFm8Bv1G8="></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.5/fuse.min.js integrity="sha256-Yrh3VGzE4d9b4KANknPJAhfcKt9SgHTL0v/FrJFoPzw=" crossorigin=anonymous></script><script type=module src=https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.esm.js></script><script nomodule src=https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.js integrity="sha256-4IG15rBugCIlZRpH7sSFc2AqT1+RAWLzMiv2rn2HMbM=" crossorigin=anonymous></script><script>tocbot.init({tocSelector:'.toc',contentSelector:'.content',headingSelector:'h1, h2, h3',hasInnerContainers:true,extraLinkClasses:'toc-page-link',listItemClass:'toc-page-item'});</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js integrity="sha256-E4RlfxwyJVmkkk0szw7LYJxuPlp6evtPSBDlWHsYYL8=" crossorigin=anonymous></script><script>anchors.options={icon:'#'}
anchors.add('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6')</script><script>const numFound=(num,results,found)=>{return `<div class="dropdown-item has-text-weight-bold">
      ${num} ${results} ${found}
    </div>
    <span class="dropdown-divider"></span>`;}
const result=(url,title,section)=>{return `<a class="dropdown-item" href="${url}">
      <p class="has-text-grey is-tiny">
        ${section}
      </p>
      <p>
        ${title}
      </p>
    </a>`;}
$(()=>{const searchBar=$('#search-bar'),searchMenu=$('#search-menu'),searchContent=$('#search-content');const options={shouldSort:true,threshold:0.6,maxPatternLength:32,minMatchCharLength:2,keys:[{name:'title',weight:0.4},{name:'tags',weight:0.2},{name:'summary',weight:0.3,},{name:'body',weight:0.1}]}
fetch('\/documentation\/index\.json').then((res)=>{return res.json();}).then((idx)=>{const fuse=new Fuse(idx,options);searchBar.on('focusin',()=>{searchBar.on('keyup',()=>{const term=searchBar.val().toLowerCase();if(term){const results=fuse.search(term);const numResults=results.length;if(numResults>0){searchMenu.show();searchContent.empty();var numAdded=0;const numTerm=(numResults==1)?'result':'results';const numItems=numFound(numResults,numTerm,'found');searchContent.append(numItems);results.forEach((res)=>{console.log(res.url);const item=result(res.url,res.title,res.section);searchContent.append(item);searchContent.show();});}}else{searchMenu.hide();}});});});});</script></body></html>