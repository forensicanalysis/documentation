<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><meta property="og:title" content="Print View"><meta property="og:type" content="article"><meta property="og:url" content="https://forensicanalysis.github.io/documentation/print/"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Elementary"><meta name=og:type content="article"><link rel=canonical content="https://forensicanalysis.github.io/documentation/print/"><meta name=generator content="Hugo 0.68.3"><title>Elementary | Print</title><link rel=stylesheet href=/documentation/css/style.d9d74fdc13c40e55d4570b1e4924d9bd385b16c5c98d19d3a3fee1f21b799fe8.css integrity="sha256-2ddP3BPEDlXUVwseSSTZvThbFsXJjRnTo/7h8ht5n+g="><link href=https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css rel=stylesheet><style>ul.contributors{list-style-type:none}ul.contributors:after{content:'';width:100%}.contributors li{text-align:center;display:inline-block;padding-bottom:20px;margin-left:10px;width:150px}.contributors li img{text-align:center;width:100px;border-radius:50%}</style><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.6.3/mermaid.min.js integrity="sha512-5CFFgWh6xMjulUNWJyY/CNrUrFjIi3ojkhHxHU0UQfxtfGXedQMauH3YEzZwa9LeyNt+6ZHzvIutTKZU9EOE4Q==" crossorigin=anonymous></script><link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400&display=swap" rel=stylesheet><style>h1,h2,h3,h4,.nav,.navbar,.title,.has-text-weight-bold,.toc{font-family:roboto slab,-apple-system,BlinkMacSystemFont,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif}.has-bottom-padding{padding-bottom:0}.hero-body,.section{padding:1.5rem}.footer{display:none}.has-text-weight-light{font-weight:600!important}.page{min-height:0}.nav-header{display:none}@media print{body{font-size:10pt}.has-restricted-width{max-width:100vh}}*{border-radius:0!important}</style></head><body class=has-navbar-fixed-top><div class=page><main class=main><section class=section><div class=container><div class="content has-restricted-width has-bottom-padding"><h1>Contents</h1><ul><li><a href=#documentation%2fmanual>The elementary documentation</a></li><li><a href=#documentation%2fmanual%2fusage>Usage</a></li><li><a href=#documentation%2fmanual%2fusage%2facquisition>Acquisition with the artifactcollector</a></li><li><a href=#documentation%2fmanual%2fusage%2fprocessing>Processing with elementary</a></li><li><a href=#documentation%2fmanual%2fdevelopment>Development</a></li><li><a href=#documentation%2fmanual%2fdevelopment%2fcustomize>Collect custom artifacts</a></li><li><a href=#documentation%2fmanual%2fdevelopment%2fcross>Cross compilation</a></li><li><a href=#documentation%2fmanual%2fdevelopment%2fplugins>Elementary plugins</a></li><li><a href=#documentation%2fmanual%2fdevelopment%2fforensicstore>Forensicstore</a></li><li><a href=#documentation%2fmanual%2fdevelopment%2fstyle_guide>Artifact definition format and style guide</a></li></ul><h1 id=documentation/manual>The elementary documentation</h1><p>This documentation supports the <code>artifactcollector</code> and <code>elementary</code> command
line tools, forensicstores and the related libraries.</p><p>While the artifactcollector can be run without special IT expertise the
elementary tooling and this documentation is aimed at forensicators, incident
responders and analysts.</p><p>The code and API
documentations are linked in the corresponding
<a href=https://github.com/forensicanalysis>GitHub repositories</a>. For questions you
can use GitHub or the
<a href=https://github.com/open-source-dfir/slack>Open Source DFIR Slack</a>.</p><p>This documentation is splitted into an <a href=usage>usage</a> sections for users of the
provided tools and a <a href=development>development</a> section for people that want to
customize or extent the tools.</p><h1 id=documentation/manual/usage>Usage</h1><div class="admonition is-warning"><div class=columns><div class="column is-1"><span class="icon has-text-warning"><ion-icon size=medium src=/documentation/img/icons/alert.svg></ion-icon></span></div><div class=column><div class=content>The elementary tools can be used as an entry point for your analysis.
Always double check your results.</div></div></div></div><h2 id=the-elementary-workflow>The elementary workflow</h2><p>The elementary workflow (not to be confused with the elementary workflow
command) is centered around the forensicstore database file. The forensicstore
can be created using either the <a href=acquisition>artifactcollector</a> on a live
system or from a disk image.</p><p>This forensicstore can be <a href=processing>processed using elementary</a> afterwards
to create reports to investigate e.g. connected usb devices or persistent
software.</p><div class=mermaid>graph LR;
A[Live System] -->|artifactcollector| B(forensicstore)
G[Disk Image] -->|elementary run import-image| B(forensicstore)
B -->|elementary run x| D[Report]</div><h1 id=documentation/manual/usage/acquisition>Acquisition with the artifactcollector</h1><div class="admonition is-danger"><div class=columns><div class="column is-1"><span class="icon has-text-danger"><ion-icon size=medium src=/documentation/img/icons/nuclear.svg></ion-icon></span></div><div class=column><div class=content>The artifactcollector behaves like malware as it collects
critical system files and might be detected as a
virus or malware.</div></div></div></div><h2 id=what-is-the-artifactcollector>What is the artifactcollector?</h2><p>The artifactcollector is a tool to collect forensic artifacts on a system. It
can be used in forensic investigations to extract specific data instead of
creating full disk images. The artifactextractor can collect low-level (like $MFT)
and high-level file artifacts as well as registry keys (e.g. run keys) which can
then be used in forensic investigations.</p><p><img src=/documentation/manual/usage/ac.png alt></p><p><strong>Figure 1. Running the artifactextractor on Windows.</strong></p><p>The artifactcollector is a single binary that can be transferred to computers which are part of a forensic investigation.</p><h2 id=download>Download</h2><p>All releases of the artifactcollector can be downloaded from <a href=https://github.com/forensicanalysis/artifactcollector/releases>GitHub</a>. Prebuild
artifactcollectors for Windows, Linux and macOS are availabe. Those
artifactcollectors collect a predefined set of artifacts which are mostly taken
from the Sans FOR500 training. Sans provides a comprehensive
<a href=https://www.sans.org/security-resources/posters/windows-forensic-analysis/170/download>poster</a>
explaining those artifacts.</p><h2 id=usage>Usage</h2><p>On Windows the <code>artifactcollector.exe</code> can be executed by double clicking it
on the investigated machine. The user will be provided with a
<a href=https://en.wikipedia.org/wiki/User_Account_Control>UAC prompt</a> because the
artifactcollector required administrator rights to run. The collection takes
some minutes, depending on processing power and contained artifacts.</p><p>On Linux and macOS the <code>artifactcollector</code> needs to be executed as root, e.g.
<code>sudo artifactcollector</code>. macOS can still prevent the execution, in this case
right click the artifactcollector, select &ldquo;Open&rdquo;, confirm &ldquo;Open&rdquo; and afterwards
try again with <code>sudo artifactcollector</code>.</p><h2 id=output>Output</h2><p>The artifactcollecor will create a .forensicstore file and a log file. The log file
serves two purposes: inform an investigator about errors during the collection but
also give the user a way to know what elements were extracted. The forensicstore
contains the results of the extraction and needs to be transferred back to the
investigator.</p><h1 id=documentation/manual/usage/processing>Processing with elementary</h1><p>Elementary is a command line tool that can create and process forensicstore
files.</p><h2 id=unpack-forensicstores>Unpack forensicstores</h2><p>To extract all file artifacts stored in the forensicstore you can use:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>elementary archive unpack TestMachine.forensicstore
</code></pre></div><p>More examples:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Extract all prefetch files</span>
elementary archive unpack --match <span style=color:#e6db74>&#34;*.pf&#34;</span> TestMachine.forensicstore

<span style=color:#75715e># Extract all windows eventlogs recreateing the original folder structure</span>
elementary archive unpack --match <span style=color:#e6db74>&#34;*.evtx&#34;</span> --mode folder <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --prefix-artifact<span style=color:#f92672>=</span>false TestMachine.forensicstore
</code></pre></div><h2 id=run-forensic-tasks>Run forensic tasks</h2><p>The <code>elementary</code> command line tool can run single commands, e.g.:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>elementary run usb TestMachine.forensicstore
</code></pre></div><h1 id=documentation/manual/development>Development</h1><p>Different organizations and investigations require flexible tools that can be
targeted to most cases, therefore the artifactcollector and elementary provide
options for customization and extension to handle as many cases as possible.</p><h1 id=documentation/manual/development/customize>Collect custom artifacts</h1><p>Forensic investigations differ and investigators have different approaches in forensic cases. The artifactcollector can cater to these needs by collecting a different set of artifacts related to the situation.</p><h2 id=collect-a-custom-set-of-artifacts>Collect a custom set of artifacts</h2><ol><li>Clone the repository <code>git clone https://github.com/forensicanalysis/artifactcollector</code>.</li><li>Run <code>go generate</code> to download all artifacts.</li><li>Add artifact definition yaml files as needed in <code>pack/artifacts</code>. Do not edit the
artifact definitions, as they will be overwritten.</li><li>Edit <code>pack/ac.yaml</code> and add the artifacts you want to collect.</li><li>Run <code>go generate</code>. This might yield some errors or problems in your artifacts.</li><li>On windows you can move the syso into the root folder (e.g. <code>cp resources\artifactcollector.syso .</code>)
to enable the icon for the executable and the UAC popup.</li><li>Run <code>go build .</code> to generates an executable.</li></ol><h3 id=define-artifacts>Define artifacts</h3><p>A structured way to define forensic artifacts was introduced by Google in development of the grr endpoint client: <a href=https://github.com/ForensicArtifacts/artifacts>https://github.com/ForensicArtifacts/artifacts</a>. We use the forked <a href=https://github.com/forensicanalysis/artifacts>https://github.com/forensicanalysis/artifacts</a> as the main repository for
forensic artifacts definitions, because the main project contains <a href=https://github.com/forensicanalysis/artifacts#backgroundhistory>some issues</a>.</p><p>The artifacts are yaml documents that define different types of forensic artifacts:</p><ul><li>Paths</li><li>Directories</li><li>Files</li><li>Registry Keys and Values</li><li>WMI Queries</li><li>Command execution</li></ul><p>Letâ€™s have a look at an artifact definition for Windows Prefetch files. The artifact defines the location of the prefetch files on Windows.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: WindowsPrefetchFiles
<span style=color:#66d9ef>doc</span>: Windows Prefetch files.
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_systemroot%%\Prefetch\*.pf&#39;</span>]
    <span style=color:#66d9ef>separator</span>: <span style=color:#e6db74>&#39;\&#39;
</span><span style=color:#e6db74>labels: [System]
</span><span style=color:#e6db74>supported_os: [Windows]
</span><span style=color:#e6db74>urls: [&#39;</span>http://www.forensicswiki.org/wiki/Prefetch&#39;]
</code></pre></div><p>If added to the artifactcollector and included in the configuration file, the artifactcollector would collect all .pf files in <code>%%environ_systemroot%%\Prefetch</code>. The <code>%%environ_systemroot%%</code> variable is replaced by the artifactcollector using the WindowsEnvironmentVariableSystemRoot artifact definition. Creating artifacts like can be done on a case by case basis if needed.</p><p>The artifact definition format is described in detail in the
<a href=https://github.com/forensicanalysis/artifacts/blob/master/style_guide.md>Style Guide</a>.</p><h3 id=embed-binaries>Embed binaries</h3><p>Binaries can be added to <code>pack/bin</code> and than included into the artifactcollector
in the <code>go generate</code> step. Additionally a corresponding COMMAND artifact like
the following is required.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: Autoruns
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: COMMAND
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>cmd</span>: autorunsc.exe
    <span style=color:#66d9ef>args</span>: [<span style=color:#e6db74>&#34;-x&#34;</span>, <span style=color:#e6db74>&#34;-accepteula&#34;</span>]
<span style=color:#66d9ef>supported_os</span>: [Windows]
</code></pre></div><p>Currently the output to stdout and stderr is saved, but generated
files are not collected.</p><h1 id=documentation/manual/development/cross>Cross compilation</h1><p>Cross compilation is a bit more difficult, as a cross compiler like MinGW is required by CGO.</p><p>Example cross compilation for Windows:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>CGO_ENABLED<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> CC<span style=color:#f92672>=</span>i686-w64-mingw32-gcc GOOS<span style=color:#f92672>=</span>windows GOARCH<span style=color:#f92672>=</span><span style=color:#ae81ff>386</span> go build .
CGO_ENABLED<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> CC<span style=color:#f92672>=</span>x86_64-w64-mingw32-gcc GOOS<span style=color:#f92672>=</span>windows GOARCH<span style=color:#f92672>=</span>amd64 go build .
</code></pre></div><h1 id=documentation/manual/development/plugins>Elementary plugins</h1><h2 id=command-types>Command types</h2><p>There are three commands types: Built-in Go Commands, Docker Commands or Script Commands.</p><h3 id=built-in-command>Built-in command</h3><p><code>elementary</code> contains some builtin commands. Those cannot be dynamically extended via plugins.</p><h3 id=docker-commands>Docker commands</h3><p>Docker commands utilize installed docker images. Those images need to be named xxx/elementary-yyy.
<code>elementary</code> loads some image on startup but also handles other images matching the
naming schema.</p><h3 id=script-commands>Script commands</h3><p>Script commands are rum from the config dir. The config is located at:</p><ul><li><code>$XDG_CONFIG_HOME/elementary</code> or <code>$HOME/.config/elementary</code> for Unix systems</li><li><code>$HOME/Library/Application Support/elementary</code> on macOS</li><li><code>%AppData%/elementary</code> on Windows</li></ul><p>The script needs to be prefixed with elementary, e.g. elementary-runkeys.py.
<code>elementary</code> installs some scripts on startup but also handles other scripts
matching the naming schema.</p><h1 id=documentation/manual/development/forensicstore>Forensicstore</h1><p>A forensicstore is a forensic database that contains selected forensic artifacts.</p><h1 id=the-forensicstore-format-version-2>The forensicstore format (version 2)</h1><p>The forensicstore format implements the following conventions:</p><ul><li>The forensicstore is a sqlite 3 database containing metadata element and
compressed raw artifacts.</li><li>The <code>elements</code> table contains all collected registry keys and values as well as
metadata on files, paths, and processes.</li><li>The files themselves as well as any process output is saved in the <code>sqlar</code> table.</li><li>Elements are represented as json objects.</li><li>Elements are valid STIX 2.1 Observable Objects where applicable.</li><li>Files stored in the forensicstore are referenced by element attributes ending
in <code>_path</code>, e.g. <code>export_path</code>, <code>stdout_path</code> and <code>wmi_path</code>.</li><li>Element attributes ending in <code>_time</code> or named <code>atime</code>, <code>ctime</code> or <code>mtime</code> are
assumed to be dates and should be stored according RFC3339/ISO 8601.</li><li>Any element stored in the forensicstore can have an errors attribute that
contains <code>errors</code> that are related to retrival or processing of this element.</li><li>Raw artifacts are stored using the deflate compression algorithm.</li><li>Artifacts with a compressed size larger than 1,000,000,000 Byte (1 GB) cannot
be stored.</li></ul><h1 id=documentation/manual/development/style_guide>Artifact definition format and style guide</h1><h1 id=artifact-definition-format-and-style-guide>Artifact definition format and style guide</h1><h2 id=summary>Summary</h2><p>This guide contains a description of the forensics artifacts definitions. The
artifacts definitions are <a href=http://www.yaml.org/spec/1.2/spec.html>YAML</a>-based.
The format is currently still under development and is likely to undergo some
change. One of the goals of this guide is to ensure consistency and readbility
of the artifacts definitions.</p><h2 id=revision-history>Revision history</h2><table><thead><tr><th>Version</th><th>Author</th><th>Date</th><th>Comments</th></tr></thead><tbody><tr><td>0.0.1</td><td>G. Castle</td><td>November 2014</td><td>Initial version.</td></tr><tr><td>0.0.2</td><td>G. Castle</td><td>December 2014</td><td>Minor format changes.</td></tr><tr><td>0.0.3</td><td>J.B. Metz</td><td>April 2015</td><td>Merged style guide and artifact definitions wiki page.</td></tr><tr><td>0.0.3</td><td>J.B. Metz</td><td>September 2015</td><td>Additional label.</td></tr><tr><td>0.0.4</td><td>J.B. Metz</td><td>July 2016</td><td>Added information about a naming convention.</td></tr><tr><td>0.0.5</td><td>J.B. Metz</td><td>February 2019</td><td>Removed returned_types as keyword and format changes.</td></tr><tr><td>0.0.6-ce</td><td>J. Plum</td><td>October 2019</td><td>Add information about the knowledge base, directory sources, expansion and globbing</td></tr></tbody></table><h2 id=background>Background</h2><p>The first version of the artifact definitions originated from the
<a href=https://github.com/google/grr>GRR project</a>, where it is used to describe and
quickly collect data of interest, e.g. specific files or Windows Registry keys.
The goal of the format is to provide a way to describe the majority of forensic
artifacts in a language that is readable by humans and machines.</p><p>The format is designed to be simple and straight forward, so that a digital
forensic analysist is able to quickly write artifact definitions during an
investigation without having to rely on complex standards or tooling.</p><p>The format is intended to describe forensically-relevant data on a machine,
while being tool agnostic. In particular we intentionally avoided adding
IOC-like logic, or describing how the data should be collected since this
varies between tools.</p><h3 id=terminology>Terminology</h3><p>The term artifact (or artefact) is widely used within computer (or digital)
forensics, though there is no official definition of this term.</p><p>The definition closest to the meaning of the word within computer forensics is
that of the word artifact within
<a href=http://en.wikipedia.org/wiki/Artifact_(archaeology)>archaeology</a>. The term
should not be confused with the word artifact used within
<a href=http://en.wikipedia.org/wiki/Artifact_(software_development)>software development</a>.</p><p>If archaeology defines an artifact as:</p><pre><code>something made or given shape by man, such as a tool or
a work of art, esp an object of archaeological interest
</code></pre><p>The definition of artifact within computer forensics could be:</p><pre><code>An object of digital archaeological interest.
</code></pre><p>Where digital archaeology roughly refers to computer forensics without the
forensic (legal) context.</p><h3 id=knowledge-base>Knowledge Base</h3><p>The knowledge base is a data store that is used for storing entries about
the host, users and other system properties. Every entry maps a key to a list
of values e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;users.username&#34;</span>: [<span style=color:#e6db74>&#34;root&#34;</span>, <span style=color:#e6db74>&#34;bob&#34;</span>],
  <span style=color:#f92672>&#34;users.homedir&#34;</span>: [<span style=color:#e6db74>&#34;/root&#34;</span>, <span style=color:#e6db74>&#34;/home/bob&#34;</span>]
}
</code></pre></div><p>It is filled via the <code>provides</code> attribute of sources and
can be used in artifact conditions (<em>deprecated</em>) and in
<a href=#parameter-expansion-and-globs>parameter expansion</a>.</p><h2 id=the-artifact-definition>The artifact definition</h2><p>The best way to show what an artifact definition is, is by example. The
following example is the artifact definition for the Windows EVTX System Event
Logs.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: WindowsSystemEventLogEvtx
<span style=color:#66d9ef>doc</span>: Windows System Event log for Vista or later systems.
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>: {<span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_systemroot%%\System32\winevt\Logs\System.evtx&#39;</span>]}
<span style=color:#66d9ef>labels</span>: [Logs]
<span style=color:#66d9ef>supported_os</span>: [Windows]
<span style=color:#66d9ef>urls</span>: [<span style=color:#e6db74>&#39;http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)&#39;</span>]
</code></pre></div><p>The artifact definition can have the following values:</p><table><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>The name. An unique string that identifies the artifact definition. Also see section: <a href=#Name>Name</a>.</td></tr><tr><td>doc</td><td>The description (or documentation). A human readable string that describes the artifact definition. <em>Style note</em>: Typically one line description of the artifact, mentioning important caveats. If more description is necessary, use the <a href=#long-docs-form>Long docs form</a>.</td></tr><tr><td>sources</td><td>A list of source definitions. See section: <a href=#sources>sources</a>.</td></tr><tr><td>labels</td><td>Optional list of labels. See section: <a href=#labels>Labels</a>.</td></tr><tr><td>supported_os</td><td>Optional list that indicates which operating systems the artifact definition applies to. See section: <a href=#supported-operating-system>Supported operating system</a>.</td></tr><tr><td>urls</td><td>Optional list of URLs with more contextual information. Ideally the artifact definition links to an article that discusses the artificat in more depth.</td></tr><tr><td><del>conditions</del></td><td><strong>Deprecated</strong> This key should be ignored.</td></tr><tr><td><del>provides</del></td><td><strong>Deprecated</strong> This key should be ignored.</td></tr></tbody></table><h3 id=name>Name</h3><p><em>Style note</em>: The name of an artifact defintion should be in CamelCase name
without spaces.</p><p>Naming convention for artifact definition names:</p><ul><li>Prefix platform specific artifact definitions with the name of the operating system using &ldquo;Linux&rdquo;, &ldquo;MacOS&rdquo; or &ldquo;Windows&rdquo;</li><li>If not platform specific:<ul><li>prefix with the application name, for example &ldquo;ChromeHistory&rdquo;.</li><li>prefix with the name of the subsystem, for example &ldquo;WMIComputerSystemProduct&rdquo;.</li></ul></li></ul><p><em>Style note</em>: If the sole source of the artifact definition for example are
files use &ldquo;BrowserHistoryFiles&rdquo; instead of &ldquo;BrowserHistory&rdquo; to reduce ambiguity.</p><h3 id=long-docs-form>Long docs form</h3><p>Multi-line documentation should use the YAML Literal Style as indicated by the |
character.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>doc</span>: <span style=color:#e6db74>|
</span><span style=color:#e6db74>  The Windows run keys.</span>

  Note users.sid will currently only expand to SIDs with profiles on the 
  system, not all SIDs.
</code></pre></div><p><em>Style note</em>: the short description (first line) and the longer portion are
separated by an empty line.</p><p><em>Style note</em>: explicit newlines (\n) should not be used.</p><h2 id=sources>Sources</h2><p>Every source definition starts with a <code>type</code> followed by arguments e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: COMMAND
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>args</span>: [-qa]
    <span style=color:#66d9ef>cmd</span>: /bin/rpm
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>:
      - /root/.bashrc
      - /root/.cshrc
      - /root/.ksh
      - /root/.logout
      - /root/.profile
      - /root/.tcsh
      - /root/.zlogin
      - /root/.zlogout
      - /root/.zprofile
      - /root/.zprofile
</code></pre></div><p><em>Style note</em>: where sources take a single argument with a single value, the
one-line {} form should be used to save on line breaks as below:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>: {<span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_systemroot%%\System32\winevt\Logs\System.evtx&#39;</span>]}
</code></pre></div><table><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>attributes</td><td>A dictionary of keyword attributes specific to the type of source definition.</td></tr><tr><td>type</td><td>The source type.</td></tr><tr><td>provides</td><td>Optional list of dictonaries that describe knowledge base entries that this artifact can supply. See section: <a href=#source-provides>Source provides</a>.</td></tr><tr><td>supported_os</td><td>Optional list that indicates which operating systems the artifact definition applies to.</td></tr><tr><td><del>conditions</del></td><td><strong>Deprecated</strong> Optional list of conditions to when the artifact definition should apply.</td></tr></tbody></table><h3 id=source-types>Source types</h3><p>Currently the following different source types are defined:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>ARTIFACT_GROUP</td><td>A source that consists of a group of other artifacts.</td></tr><tr><td>COMMAND</td><td>A source that consists of the output of a command.</td></tr><tr><td>DIRECTORY</td><td>A source that consists of the file listing of a directories.</td></tr><tr><td>FILE</td><td>A source that consists of the contents of files.</td></tr><tr><td>PATH</td><td>A source that consists of a list of paths.</td></tr><tr><td>REGISTRY_KEY</td><td>A source that consists of the contents of Windows Registry keys.</td></tr><tr><td>REGISTRY_VALUE</td><td>A source that consists of the contents of Windows Registry values.</td></tr><tr><td>WMI</td><td>A source that consists of the output of a Windows Management Instrumentation (WMI) query.</td></tr></tbody></table><h3 id=source-provides>Source provides</h3><p>A source provide defines a knowledge base entry that can be created using this source e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: PATH
  <span style=color:#66d9ef>attributes</span>: {<span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;/Users/*&#39;</span>]}
  <span style=color:#66d9ef>provides</span>:
    - <span style=color:#66d9ef>key</span>: users.username
      <span style=color:#66d9ef>regex</span>: <span style=color:#e6db74>&#39;.*/(.*)&#39;</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: WMI
  <span style=color:#66d9ef>attributes</span>: {<span style=color:#66d9ef>query</span>: SELECT * FROM Win32_UserAccount WHERE name=<span style=color:#e6db74>&#39;%%users.username%%&#39;</span>}
  <span style=color:#66d9ef>provides</span>: 
    - <span style=color:#66d9ef>key</span>: users.userdomain
      <span style=color:#66d9ef>wmi_key</span>: Domain
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>: {<span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;/etc/passwd&#39;</span>]}
  <span style=color:#66d9ef>provides</span>: 
    - <span style=color:#66d9ef>key</span>: users.username
      <span style=color:#66d9ef>regex</span>: <span style=color:#e6db74>&#39;(.*?):.*&#39;</span>
    - <span style=color:#66d9ef>key</span>: users.homedir
      <span style=color:#66d9ef>regex</span>: <span style=color:#e6db74>&#39;.*:(.*?):.*&#39;</span>
</code></pre></div><table><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>key</td><td>Defines the knowledge base key that is provided.</td></tr><tr><td>wmi_key</td><td>Required for provides in WMI sources, disallowed otherwise. WMI object key to select the provided value.</td></tr><tr><td>regex</td><td>Optional regular expression to filter the provided data. The first capturing group defines the provided value.</td></tr></tbody></table><p>Provided values are dependend on the source type as follows:</p><table><thead><tr><th>Type</th><th>Added entries to knowledge base</th></tr></thead><tbody><tr><td>COMMAND</td><td>The lines of the stdout of the command.</td></tr><tr><td>FILE</td><td>The lines of the file content.</td></tr><tr><td>PATH</td><td>The defined paths.</td></tr><tr><td>REGISTRY_KEY</td><td>The key paths.</td></tr><tr><td>REGISTRY_VALUE</td><td>The registry values.</td></tr><tr><td>WMI</td><td>The values selected using the <code>wmi_key</code>.</td></tr></tbody></table><p>Definition of type ARTIFACT_GROUP or DIRECTORY must not have a <code>provides</code> attribute.</p><h3 id=artifact-group-source>Artifact group source</h3><p>The artifact group source is a source that consists of a group of other
artifacts e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: ARTIFACT_GROUP
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>names</span>: [WindowsRunKeys, WindowsServices]
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>names</td><td>A list of artifact definition names that make up this &ldquo;composite&rdquo; artifact. This can also be used to group multiple artifact definitions into one for convenience.</td></tr></tbody></table><h3 id=command-source>Command source</h3><p>The command source is a source that consists of the output of a command e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: COMMAND
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>args</span>: [-qa]
    <span style=color:#66d9ef>cmd</span>: /bin/rpm
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>args</td><td>A list arguments to pass to the command.</td></tr><tr><td>cmd</td><td>The path of the command. The path can either be relative or absolute. Handling of relative paths depends on the application processing the artifact.</td></tr></tbody></table><h3 id=directory-source>Directory source</h3><p>The directory source is a source that consists of a file listing of directory contents e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: DIRECTORY
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%users.userprofile%%\Downloads\*&#39;</span>]
    <span style=color:#66d9ef>separator</span>: <span style=color:#e6db74>&#39;\&#39;</span>
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>paths</td><td>A list of file paths that can potentially be collected. These paths should be absolute. The paths can use parameter expansion e.g. <code>%%environ_systemroot%%</code>. See section: <a href=#parameter-expansion-and-globs>Parameter expansion and globs</a></td></tr><tr><td>separator</td><td>Optional path seperator e.g. &lsquo;' for Windows systems.</td></tr></tbody></table><h3 id=file-source>File source</h3><p>The file source is a source that consists of the binary contents of files e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_systemroot%%\System32\winevt\Logs\System.evtx&#39;</span>]
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>paths</td><td>A list of file paths that can potentially be collected. These paths should be absolute. The paths can use parameter expansion e.g. <code>%%environ_systemroot%%</code>. See section: <a href=#parameter-expansion-and-globs>Parameter expansion and globs</a></td></tr><tr><td>separator</td><td>Optional path seperator e.g. &lsquo;' for Windows systems.</td></tr></tbody></table><h3 id=path-source>Path source</h3><p>The path source is a source that consists of a list of paths e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: PATH
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;\Program Files&#39;</span>]
    <span style=color:#66d9ef>separator</span>: <span style=color:#e6db74>&#39;\&#39;</span>
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>paths</td><td>A list of file paths that can potentially be collected. These paths can should be absolute. The paths can use parameter expansion e.g. <code>%%environ_systemroot%%</code>. See section: <a href=#parameter-expansion>Parameter expansion and globs</a></td></tr><tr><td>separator</td><td>Optional path seperator e.g. &lsquo;' for Windows systems.</td></tr></tbody></table><h3 id=windows-registry-key-source>Windows Registry key source</h3><p>The Windows Registry key source is a source that consists of a key path and all
registry values of a Windows Registry key. Subkeys are not part of this artifact.</p><p>Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: REGISTRY_KEY
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>keys</span>:
    - <span style=color:#e6db74>&#39;HKEY_USERS\%%users.sid%%\Software\Microsoft\Internet Explorer\TypedURLs\*&#39;</span>
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>keys</td><td>A list of Windows Registry key paths that can potentially be collected. The paths can use parameter expansion e.g. <code>%%users.sid%%</code>. See section: <a href=#parameter-expansion>Parameter expansion and globs</a></td></tr></tbody></table><h3 id=windows-registry-value-source>Windows Registry value source</h3><p>The Windows Registry value source is a source that consists of the contents of defined
Windows registry values e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: REGISTRY_VALUE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>key_value_pairs</span>:
      - {<span style=color:#66d9ef>key: &#39;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\WindowsUpdate&#39;, value</span>: <span style=color:#e6db74>&#39;CISCNF4654&#39;</span>}
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>key_value_pairs</td><td>A list of Windows Registry key paths and value names that can potentially be collected. The key path can use parameter expansion e.g. <code>%%users.sid%%</code>. See section: <a href=#parameter-expansion>Parameter expansion and globs</a></td></tr></tbody></table><h3 id=windows-management-instrumentation-wmi-query-source>Windows Management Instrumentation (WMI) query source</h3><p>The Windows Management Instrumentation (WMI) query source is a source that
consists of the output of a Windows Management Instrumentation (WMI) query e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#66d9ef>type</span>: WMI
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>query</span>: SELECT * FROM Win32_UserAccount WHERE name=<span style=color:#e6db74>&#39;%%users.username%%&#39;</span>
</code></pre></div><p>Where <code>attributes</code> can contain the following values:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>query</td><td>The Windows Management Instrumentation (WMI) query. The query can use parameter expansion e.g. <code>%%users.username%%</code>. See section: <a href=#parameter-expansion-and-globs>Parameter expansion and globs</a></td></tr><tr><td>base_object</td><td>Optional WMI base object e.g. <code>winmgmts:\root\SecurityCenter2</code></td></tr></tbody></table><h2 id=supported-operating-system>Supported operating system</h2><p>Since operating system (OS) conditions are a very common constraint, this has
been provided as a separate option <code>supported_os</code> to simplify syntax. For
supported_os no quotes are required. The currently supported operating systems
are:</p><ul><li>Darwin (also used for Mac OS X)</li><li>Linux</li><li>Windows</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>supported_os</span>: [Darwin, Linux, Windows]
</code></pre></div><h2 id=labels>Labels</h2><p>Currently the following different labels are pre-defined:</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>Antivirus</td><td>Antivirus related artifacts, e.g. quarantine files.</td></tr><tr><td>Authentication</td><td>Authentication artifacts.</td></tr><tr><td>Browser</td><td>Web Browser artifacts.</td></tr><tr><td>Cloud Storage</td><td>Cloud Storage artifacts.</td></tr><tr><td>Configuration Files</td><td>Configuration files artifacts.</td></tr><tr><td>Execution</td><td>Contain execution events.</td></tr><tr><td>External Media</td><td>Contain external media data or events e.g. USB drives.</td></tr><tr><td>KnowledgeBase</td><td>Artifacts used in knowledge base generation.</td></tr><tr><td>Logs</td><td>Contain log files.</td></tr><tr><td>Memory</td><td>Artifacts retrieved from memory.</td></tr><tr><td>Network</td><td>Describe networking state.</td></tr><tr><td>Processes</td><td>Describe running processes.</td></tr><tr><td>Software</td><td>Installed software.</td></tr><tr><td>System</td><td>Core system artifacts.</td></tr><tr><td>Users</td><td>Information about users.</td></tr></tbody></table><p>Additional lables are allowed.</p><h2 id=style-notes>Style notes</h2><h3 id=artifact-definition-yaml-files>Artifact definition YAML files</h3><p>Artifact definition YAML filenames should be of the form:
&mldr;.
$FILENAME.yaml
&mldr;.</p><p>Where $FILENAME is name of the file e.g. windows.yaml.</p><p>Each defintion file should have a comment at the top of the file with a
one-line summary describing the type of artifact definitions contained in the
file e.g.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># Windows specific artifacts.</span>
</code></pre></div><h3 id=lists>Lists</h3><p>Generally use the short [] format for single-item lists that fit inside 80
characters to save on unnecessary line breaks:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>labels</span>: [Logs]
<span style=color:#66d9ef>supported_os</span>: [Windows]
<span style=color:#66d9ef>urls</span>: [<span style=color:#e6db74>&#39;http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)&#39;</span>]
</code></pre></div><p>and the bulleted list form for multi-item lists or long lines:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>paths</span>:
  - <span style=color:#e6db74>&#39;HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Run\*&#39;</span>
  - <span style=color:#e6db74>&#39;HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\RunOnce\*&#39;</span>
  - <span style=color:#e6db74>&#39;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\*&#39;</span>
  - <span style=color:#e6db74>&#39;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce\*&#39;</span>
  - <span style=color:#e6db74>&#39;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx\*&#39;</span>
</code></pre></div><h3 id=quotes>Quotes</h3><p>Quotes should not be used for doc strings, artifact names, and simple lists
like labels and supported_os.</p><p>Paths and URLs should use single quotes to avoid the need for manual escaping.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%environ_temp%%\*.exe&#39;</span>]
<span style=color:#66d9ef>urls</span>: [<span style=color:#e6db74>&#39;http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)&#39;</span>]
</code></pre></div><p>Double quotes should be used where escaping causes problems, such as
regular expressions:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>content_regex_list</span>: [<span style=color:#e6db74>&#34;^%%users.username%%:[^:]*\n&#34;</span>]
</code></pre></div><h3 id=minimize-the-number-of-definitions-by-using-multiple-sources>Minimize the number of definitions by using multiple sources</h3><p>To minimize the number of artifacts in the list, combine them using the
supported_os and conditions attributes where it makes sense. e.g. rather than
having FirefoxHistoryWindows, FirefoxHistoryLinux, FirefoxHistoryDarwin, do:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: FirefoxHistory
<span style=color:#66d9ef>doc</span>: Firefox places.sqlite files.
<span style=color:#66d9ef>sources</span>:
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>:
      - %%users.localappdata%%\Mozilla\Firefox\Profiles\<span style=color:#75715e>*\places.sqlite</span>
      - %%users.appdata%%\Mozilla\Firefox\Profiles\<span style=color:#75715e>*\places.sqlite</span>
  <span style=color:#66d9ef>supported_os</span>: [Windows]
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [%%users.homedir%%/Library/Application Support/Firefox/Profiles/<span style=color:#75715e>*/places.sqlite]</span>
  <span style=color:#66d9ef>supported_os</span>: [Darwin]
- <span style=color:#66d9ef>type</span>: FILE
  <span style=color:#66d9ef>attributes</span>:
    <span style=color:#66d9ef>paths</span>: [<span style=color:#e6db74>&#39;%%users.homedir%%/.mozilla/firefox/*/places.sqlite&#39;</span>]
  <span style=color:#66d9ef>supported_os</span>: [Linux]
<span style=color:#66d9ef>labels</span>: [Browser]
<span style=color:#66d9ef>supported_os</span>: [Windows, Linux, Darwin]
</code></pre></div><h2 id=parameter-expansion-and-globs>Parameter expansion and globs</h2><h3 id=parameter-expansion>Parameter expansion</h3><p>Path, keys, key and query attributes can contain parameter expansion and
globing. This allows for flexible creation of artifact locations.</p><p>Parameter expansions values are enclosed by double percent symbols e.g.
<code>%%environ_systemroot%%</code>. The parameter expansion value can be replaced by the
corresponding value from the <a href=#knowledge-base>knowledge base</a>.</p><p>For every expansion that is used in an artifact, there should be another artifact
that <code>provides</code> this expansion in one of its sources. Implementations may choose
to precompute parameter values from sources outside of these definitions.</p><h3 id=parameter-globs>Parameter Globs</h3><p>Parameters can also contain regular glob elements (<code>**</code>, or <code>*</code>).
For example, having files <code>foo</code>, <code>bar</code>, <code>baz</code> glob expansion of <code>ba*</code>
will yield <code>bar</code> and <code>baz</code>. A recursive component (specified as <code>**</code>)
matches any directory tree up to some specified depth (3 by default).
<code>**</code> does not match the current directory.
The search depth can optionally be specified by appending a number, e.g.
<code>**9</code> will match up to 9 levels of a directory hierarchy.</p></div></div></section></main></div><script src=/documentation/js/app.8aa12458222656d47218d0154d69257c4435211c645649b4c677859bc06fd46f.js integrity="sha256-iqEkWCImVtRyGNAVTWklfEQ1IRxkVkm0xneFm8Bv1G8="></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.5/fuse.min.js integrity="sha256-Yrh3VGzE4d9b4KANknPJAhfcKt9SgHTL0v/FrJFoPzw=" crossorigin=anonymous></script><script type=module src=https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.esm.js></script><script nomodule src=https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.js></script><script>const numFound=(num,results,found)=>{return `<div class="dropdown-item has-text-weight-bold">
      ${num} ${results} ${found}
    </div>
    <span class="dropdown-divider"></span>`;}
const result=(url,title,section)=>{return `<a class="dropdown-item" href="${url}">
      <p class="has-text-grey is-tiny">
        ${section}
      </p>
      <p>
        ${title}
      </p>
    </a>`;}
$(()=>{const searchBar=$('#search-bar'),searchMenu=$('#search-menu'),searchContent=$('#search-content');const options={shouldSort:true,threshold:0.6,maxPatternLength:32,minMatchCharLength:2,keys:[{name:'title',weight:0.4},{name:'tags',weight:0.2},{name:'summary',weight:0.3,},{name:'body',weight:0.1}]}
fetch('\/documentation\/index\.json').then((res)=>{return res.json();}).then((idx)=>{const fuse=new Fuse(idx,options);searchBar.on('focusin',()=>{searchBar.on('keyup',()=>{const term=searchBar.val().toLowerCase();if(term){const results=fuse.search(term);const numResults=results.length;if(numResults>0){searchMenu.show();searchContent.empty();var numAdded=0;const numTerm=(numResults==1)?'result':'results';const numItems=numFound(numResults,numTerm,'found');searchContent.append(numItems);results.forEach((res)=>{console.log(res.url);const item=result(res.url,res.title,res.section);searchContent.append(item);searchContent.show();});}}else{searchMenu.hide();}});});});});</script></body></html>